      function Fex2_and_11_T3T4(beta,cost)
      ! This routine returns the contribution to T3T4
      ! coming from Fex2(0)-2*pi*b0*Fex1(1), values for
      ! CA and nf fixed by the init_interpolation_T3T4 call
      ! Here beta=sqrt(1-4*mt**2/s)
      implicit none
      double precision Fex2_and_11_T3T4,beta,beta2,cost
      real beta2_r,cost_r,interpolationT3T4
      external interpolationT3T4

      beta2 = beta*beta
      beta2_r = real(beta2)
      cost_r = real(cost)
      Fex2_and_11_T3T4 = dble(interpolationT3T4(beta2_r,cost_r))
      Fex2_and_11_T3T4 = Fex2_and_11_T3T4*(1.d0+dlog(1.d0-beta2)**2.d0)

      return
      end

      subroutine init_interpolation_T3T4()
c     This routine loads directly the parameters resulting from
c     the interpolation of the relevant grids.
c     WARNING: valid for CA=3 and nf=5 only!
      implicit none
      integer i
      integer kx,ky,nmax,nx,ny
      parameter (nmax=210)
      real tx(nmax),ty(nmax),c(50000)
      common/interpT3T4/tx,ty,c,nx,ny,kx,ky

c      write(*,*)"nx = ",nx
c      write(*,*)"ny = ",ny
c      write(*,*)"kx = ",kx
c      write(*,*)"ky = ",ky
c      do i=1,nmax
c      if(tx(i).ne.0.) write(*,*)"tx(",i,") = ",tx(i)
c      if(ty(i).ne.0.) write(*,*)"ty(",i,") = ",ty(i)
c      enddo
c      do i=1,50000
c      if(c(i).ne.0.) write(*,*)"c(",i,") = ",c(i)
c      enddo

      do i=1,nmax
      tx(i) = 0.
      ty(i) = 0.
      enddo
      do i=1,50000
      c(i) = 0.
      enddo

      nx = 27
      ny = 18
      kx =  3
      ky =  3
      ty( 1 ) =   -1.00000000    
      ty( 2 ) =   -1.00000000    
      ty( 3 ) =   -1.00000000    
      ty( 4 ) =   -1.00000000    
      tx( 5 ) =    1.43897254E-03
      ty( 5 ) =  -0.865056276    
      tx( 6 ) =    2.22730893E-03
      ty( 6 ) =  -0.622893989    
      tx( 7 ) =    2.86151702E-03
      ty( 7 ) =  -0.437533557    
      tx( 8 ) =    4.63516498E-03
      ty( 8 ) =  -0.312636644    
      tx( 9 ) =    1.90300811E-02
      ty( 9 ) =   -7.04257924E-04
      tx(10 ) =    3.88562046E-02
      ty(10 ) =   0.309278846    
      tx(11 ) =    8.76794085E-02
      ty(11 ) =   0.444819331    
      tx(12 ) =   0.204808503    
      ty(12 ) =   0.613882661    
      tx(13 ) =   0.335318267    
      ty(13 ) =   0.861048341    
      tx(14 ) =   0.440830827    
      ty(14 ) =   0.957732439    
      tx(15 ) =   0.565302193    
      ty(15 ) =    1.00000000    
      tx(16 ) =   0.698588133    
      ty(16 ) =    1.00000000    
      tx(17 ) =   0.778950453    
      ty(17 ) =    1.00000000    
      tx(18 ) =   0.856596649    
      ty(18 ) =    1.00000000    
      tx(19 ) =   0.900431812    
      tx(20 ) =   0.929468811    
      tx(21 ) =   0.947954297    
      tx(22 ) =   0.963470995    
      tx(23 ) =   0.978465199    
      tx(24 ) =    1.00000000    
      tx(25 ) =    1.00000000    
      tx(26 ) =    1.00000000    
      tx(27 ) =    1.00000000    
      c( 2 ) =   0.720484436    
      c( 3 ) =   0.876726270    
      c( 4 ) =   0.839513898    
      c( 5 ) =   -4.59727384E-02
      c( 6 ) =    1.01665056    
      c( 7 ) =    2.60551000    
      c( 8 ) =    1.00157356    
      c( 9 ) =  -0.104585432    
      c(10 ) =    2.27354884    
      c(11 ) =   0.850904882    
      c(12 ) =   0.631416261    
      c(13 ) =    1.39782045E-04
      c(14 ) =   -7.87153676E-12
      c(15 ) =    7.03996466E-06
      c(16 ) =    1.03138673    
      c(17 ) =    1.51897860    
      c(18 ) =   0.395991892    
      c(19 ) =    2.32164502    
      c(20 ) =   0.611784637    
      c(21 ) =   -1.06988192    
      c(22 ) =   0.651329875    
      c(23 ) =    2.27392435    
      c(24 ) =  -0.181685820    
      c(25 ) =    1.61360455    
      c(26 ) =    1.27654922    
      c(27 ) =    2.82601453E-04
      c(28 ) =   -1.00250252E-13
      c(29 ) =    1.96990800E-06
      c(30 ) =   0.414305300    
      c(31 ) =   0.770147204    
      c(32 ) =   0.895066559    
      c(33 ) =    2.73169374    
      c(34 ) =    2.21496105    
      c(35 ) =   0.833496451    
      c(36 ) =    2.29697490    
      c(37 ) =    2.54554415    
      c(38 ) =    1.06586885    
      c(39 ) =  -0.236429125    
      c(40 ) =   0.358232975    
      c(41 ) =    7.93050203E-05
      c(42 ) =    6.90666968E-11
      c(43 ) =   0.760332763    
      c(44 ) =   0.874929428    
      c(45 ) =    1.07408690    
      c(46 ) =    1.25667942    
      c(47 ) =    1.51519871    
      c(48 ) =    1.71257722    
      c(49 ) =    1.51908720    
      c(50 ) =    1.70438409    
      c(51 ) =    1.52090967    
      c(52 ) =    1.61697233    
      c(53 ) =    1.25371981    
      c(54 ) =   0.704822838    
      c(55 ) =   0.722197473    
      c(56 ) =   -4.04943489E-02
      c(57 ) =    1.56504536    
      c(58 ) =    1.41685522    
      c(59 ) =    1.76164722    
      c(60 ) =    1.68886864    
      c(61 ) =    1.85900927    
      c(62 ) =    1.93933058    
      c(63 ) =    2.07230902    
      c(64 ) =    1.94256830    
      c(65 ) =    1.85999858    
      c(66 ) =    1.68632185    
      c(67 ) =    1.76620555    
      c(68 ) =    1.45577276    
      c(69 ) =    1.49310684    
      c(70 ) =   -1.26345884E-02
      c(71 ) =    1.30813277    
      c(72 ) =    1.41854250    
      c(73 ) =    1.54934359    
      c(74 ) =    1.84555924    
      c(75 ) =    1.97521996    
      c(76 ) =    2.10510492    
      c(77 ) =    2.16185808    
      c(78 ) =    2.10421205    
      c(79 ) =    1.97638261    
      c(80 ) =    1.84692335    
      c(81 ) =    1.57820106    
      c(82 ) =    1.43071973    
      c(83 ) =    1.37100089    
      c(84 ) =    1.31860697    
      c(85 ) =   0.620434821    
      c(86 ) =   0.715601206    
      c(87 ) =   0.989820242    
      c(88 ) =    1.28562796    
      c(89 ) =    1.50829387    
      c(90 ) =    1.67768049    
      c(91 ) =    1.76563942    
      c(92 ) =    1.67839813    
      c(93 ) =    1.50870478    
      c(94 ) =    1.28980362    
      c(95 ) =    1.01693273    
      c(96 ) =   0.757227600    
      c(97 ) =   0.618992209    
      c(98 ) =   0.669828176    
      c(99 ) =   -1.22054636    
      c(  100 ) =   -1.07116663    
      c(  101 ) =  -0.733167946    
      c(  102 ) =  -0.320970416    
      c(  103 ) =   -4.48410772E-02
      c(  104 ) =   0.173529729    
      c(  105 ) =   0.288734019    
      c(  106 ) =   0.173618034    
      c(  107 ) =   -4.30904217E-02
      c(  108 ) =  -0.318833828    
      c(  109 ) =  -0.690688550    
      c(  110 ) =   -1.03027856    
      c(  111 ) =   -1.17159688    
      c(  112 ) =   -1.22125256    
      c(  113 ) =   -4.97843933    
      c(  114 ) =   -4.82166719    
      c(  115 ) =   -4.40496731    
      c(  116 ) =   -3.93758965    
      c(  117 ) =   -3.62014341    
      c(  118 ) =   -3.37067652    
      c(  119 ) =   -3.25234294    
      c(  120 ) =   -3.37067366    
      c(  121 ) =   -3.61803198    
      c(  122 ) =   -3.93521476    
      c(  123 ) =   -4.35624790    
      c(  124 ) =   -4.77076483    
      c(  125 ) =   -4.92821312    
      c(  126 ) =   -4.98014975    
      c(  127 ) =   -9.83720779    
      c(  128 ) =   -9.66378593    
      c(  129 ) =   -9.24302673    
      c(  130 ) =   -8.79119682    
      c(  131 ) =   -8.50030613    
      c(  132 ) =   -8.27700901    
      c(  133 ) =   -8.17056847    
      c(  134 ) =   -8.27668095    
      c(  135 ) =   -8.49870110    
      c(  136 ) =   -8.78891277    
      c(  137 ) =   -9.19626331    
      c(  138 ) =   -9.61137199    
      c(  139 ) =   -9.78400993    
      c(  140 ) =   -9.83617210    
      c(  141 ) =   -13.6213474    
      c(  142 ) =   -13.4526300    
      c(  143 ) =   -13.0497780    
      c(  144 ) =   -12.6595201    
      c(  145 ) =   -12.4169226    
      c(  146 ) =   -12.2375174    
      c(  147 ) =   -12.1547327    
      c(  148 ) =   -12.2375536    
      c(  149 ) =   -12.4155140    
      c(  150 ) =   -12.6578035    
      c(  151 ) =   -13.0084257    
      c(  152 ) =   -13.4030190    
      c(  153 ) =   -13.5678692    
      c(  154 ) =   -13.6218395    
      c(  155 ) =   -15.3330297    
      c(  156 ) =   -15.1622810    
      c(  157 ) =   -14.7841024    
      c(  158 ) =   -14.4480963    
      c(  159 ) =   -14.2511148    
      c(  160 ) =   -14.1078424    
      c(  161 ) =   -14.0436583    
      c(  162 ) =   -14.1075974    
      c(  163 ) =   -14.2499743    
      c(  164 ) =   -14.4475155    
      c(  165 ) =   -14.7479620    
      c(  166 ) =   -15.1149483    
      c(  167 ) =   -15.2810736    
      c(  168 ) =   -15.3321142    
      c(  169 ) =   -14.9396477    
      c(  170 ) =   -14.7646761    
      c(  171 ) =   -14.4000235    
      c(  172 ) =   -14.1068983    
      c(  173 ) =   -13.9352293    
      c(  174 ) =   -13.8145456    
      c(  175 ) =   -13.7581234    
      c(  176 ) =   -13.8145638    
      c(  177 ) =   -13.9344225    
      c(  178 ) =   -14.1061707    
      c(  179 ) =   -14.3680182    
      c(  180 ) =   -14.7192907    
      c(  181 ) =   -14.8847408    
      c(  182 ) =   -14.9402790    
      c(  183 ) =   -12.7605419    
      c(  184 ) =   -12.5723543    
      c(  185 ) =   -12.2171297    
      c(  186 ) =   -11.9394464    
      c(  187 ) =   -11.7738600    
      c(  188 ) =   -11.6541080    
      c(  189 ) =   -11.5989456    
      c(  190 ) =   -11.6539640    
      c(  191 ) =   -11.7727022    
      c(  192 ) =   -11.9388628    
      c(  193 ) =   -12.1866980    
      c(  194 ) =   -12.5274258    
      c(  195 ) =   -12.7023678    
      c(  196 ) =   -12.7590551    
      c(  197 ) =   -10.0875778    
      c(  198 ) =   -9.88781071    
      c(  199 ) =   -9.53431511    
      c(  200 ) =   -9.25332737    
      c(  201 ) =   -9.07375622    
      c(  202 ) =   -8.94342899    
      c(  203 ) =   -8.88032818    
      c(  204 ) =   -8.94334316    
      c(  205 ) =   -9.07292175    
      c(  206 ) =   -9.25224400    
      c(  207 ) =   -9.50383759    
      c(  208 ) =   -9.84343243    
      c(  209 ) =   -10.0248804    
      c(  210 ) =   -10.0885038    
      c(  211 ) =   -7.96617651    
      c(  212 ) =   -7.75283527    
      c(  213 ) =   -7.39994574    
      c(  214 ) =   -7.09374285    
      c(  215 ) =   -6.89637280    
      c(  216 ) =   -6.74895191    
      c(  217 ) =   -6.67863703    
      c(  218 ) =   -6.74903870    
      c(  219 ) =   -6.89479399    
      c(  220 ) =   -7.09296989    
      c(  221 ) =   -7.36624432    
      c(  222 ) =   -7.70895767    
      c(  223 ) =   -7.89798927    
      c(  224 ) =   -7.96713495    
      c(  225 ) =   -6.25481510    
      c(  226 ) =   -6.03065205    
      c(  227 ) =   -5.66057158    
      c(  228 ) =   -5.31529617    
      c(  229 ) =   -5.09305620    
      c(  230 ) =   -4.92692041    
      c(  231 ) =   -4.84506989    
      c(  232 ) =   -4.92674637    
      c(  233 ) =   -5.09165621    
      c(  234 ) =   -5.31432056    
      c(  235 ) =   -5.62308025    
      c(  236 ) =   -5.98614740    
      c(  237 ) =   -6.18076801    
      c(  238 ) =   -6.25876570    
      c(  239 ) =   -5.14419889    
      c(  240 ) =   -4.91052151    
      c(  241 ) =   -4.51391411    
      c(  242 ) =   -4.12177324    
      c(  243 ) =   -3.88230610    
      c(  244 ) =   -3.69417262    
      c(  245 ) =   -3.61134100    
      c(  246 ) =   -3.69531608    
      c(  247 ) =   -3.87907362    
      c(  248 ) =   -4.12293959    
      c(  249 ) =   -4.46844101    
      c(  250 ) =   -4.86457109    
      c(  251 ) =   -5.06587696    
      c(  252 ) =   -5.15416431    
      c(  253 ) =   -4.32892942    
      c(  254 ) =   -4.07665348    
      c(  255 ) =   -3.63737512    
      c(  256 ) =   -3.20921254    
      c(  257 ) =   -2.94370246    
      c(  258 ) =   -2.74883032    
      c(  259 ) =   -2.64910650    
      c(  260 ) =   -2.74736094    
      c(  261 ) =   -2.94266725    
      c(  262 ) =   -3.20906472    
      c(  263 ) =   -3.58891177    
      c(  264 ) =   -4.02702856    
      c(  265 ) =   -4.24175310    
      c(  266 ) =   -4.33265305    
      c(  267 ) =   -3.63876486    
      c(  268 ) =   -3.36921215    
      c(  269 ) =   -2.87370420    
      c(  270 ) =   -2.39253616    
      c(  271 ) =   -2.12117982    
      c(  272 ) =   -1.88740170    
      c(  273 ) =   -1.81522965    
      c(  274 ) =   -1.89373767    
      c(  275 ) =   -2.11374283    
      c(  276 ) =   -2.39646602    
      c(  277 ) =   -2.81607819    
      c(  278 ) =   -3.31129646    
      c(  279 ) =   -3.54515934    
      c(  280 ) =   -3.65366173    
      c(  281 ) =   -2.81951594    
      c(  282 ) =   -2.49081993    
      c(  283 ) =   -1.88093317    
      c(  284 ) =   -1.37466514    
      c(  285 ) =   -1.01332438    
      c(  286 ) =  -0.861324608    
      c(  287 ) =  -0.620260656    
      c(  288 ) =  -0.837514460    
      c(  289 ) =   -1.02805710    
      c(  290 ) =   -1.36854005    
      c(  291 ) =   -1.82582188    
      c(  292 ) =   -2.42417431    
      c(  293 ) =   -2.71091199    
      c(  294 ) =   -2.80201626    
      c(  295 ) =   -2.06370997    
      c(  296 ) =   -1.63720834    
      c(  297 ) =  -0.867366791    
      c(  298 ) =  -0.191396073    
      c(  299 ) =    6.89270580E-03
      c(  300 ) =   0.552144051    
      c(  301 ) =   0.388151467    
      c(  302 ) =   0.454948753    
      c(  303 ) =    7.58956224E-02
      c(  304 ) =  -0.210308522    
      c(  305 ) =  -0.777948976    
      c(  306 ) =   -1.54005146    
      c(  307 ) =   -1.91790390    
      c(  308 ) =   -2.19797492    
      c(  309 ) =   -1.37650967    
      c(  310 ) =  -0.494967520    
      c(  311 ) =    1.27719355    
      c(  312 ) =   0.918531299    
      c(  313 ) =    2.22015119    
      c(  314 ) =   0.761468768    
      c(  315 ) =    7.16225356E-02
      c(  316 ) =    1.61881828    
      c(  317 ) =    1.81722260    
      c(  318 ) =   0.923501015    
      c(  319 ) =    1.25719762    
      c(  320 ) =  -0.149265975    
      c(  321 ) =   -1.25202310    
      c(  322 ) =  -0.436634690



      return
      end

      function interpolationT3T4(xv,yv)
      implicit none
      real interpolationT3T4,xv,yv
      integer i
      integer iopt,m,kx,ky,nxest,nyest,nmax,nx,ny,
     &        lwrk1,lwrk2,kwrk,ier,lwrk
      parameter (m=10000)
      parameter (nmax=210)
      parameter (lwrk1=100000000)
      parameter (lwrk2=50000000)
      parameter (kwrk=70000)
      parameter (lwrk=50)
      integer iwrk(kwrk)
      real x(m),y(m),z(m),w(m),xb,xe,yb,ye,s,eps,
     &   tx(nmax),ty(nmax),c(50000),fp,wrk1(lwrk1),wrk2(lwrk2)
      integer mx,my
      real xx(1),yy(1),zz(1),wrk(lwrk)
      common/interpT3T4/tx,ty,c,nx,ny,kx,ky

      mx = 1 
      my = 1

      xx(1) = xv
      yy(1) = yv

      call bispev(tx,nx,ty,ny,c,kx,ky,xx,mx,yy,my,zz,wrk,lwrk,
     &  iwrk,kwrk,ier)

      interpolationT3T4 = zz(1)

      return
      end

